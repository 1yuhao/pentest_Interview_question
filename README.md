## 渗透工程师面试题总结

#### 拿到一个待检测的站，你觉得应该先做什么？

```
whois
	http://whois.chinaz.com/
网站源ip
	http://ip.tool.chinaz.com/bilibili.com
二级域名
	扫描器(代码待定)
C段网站
	cScan.py
服务器系统版本、容器版本
	云息指纹(代码待定)
防火墙
	nmap -p80 --script http-waf-detect xxx.com
端口
	nmap -sV -T4 -O -Pn  xxx.xxx.xx.xx
```

cScan.py附件

```python
import socket
socket.setdefaulttimeout(1)
#查询
print('[*]查询中')
def orf():
  a=open('1.txt','r')
  for g in a.readlines():
    gv=g.strip('\r').strip('\n')
    s=socket.socket()
    try:
      s.connect((gv,80))
      print('该IP有网站:'+gv)
    except:
      pass
#gib()
orf()
```

#### 主流数据库的SQL特有函数、存储过程

```
MySQL
MSSQL
Oracle
PostgreSQL
Access
SQLite
```

#### Wireshark语法

#### TCPdump

#### urllib2

####  XSS类型和攻击原理

```
反射型xss
	在浏览器上运行一遍就会造成的攻击，运行一次，不会长时间留存
存储型xss
	多见于评论处，恶意xss代码写进服务器中，每一次运行都会造成危害，长时间留存
常见恶意代码如下
 ><script>alert(document.cookie)</script>
 <IMG SRC="javascript:alert('XSS');">;
 <BODY BACKGROUND="javascript:alert('XSS')">
 <STYLE>li {list-style-image: url("javascript:alert('XSS')");}</STYLE><UL><LI>XSS</br>
 <LINK REL="stylesheet" HREF="javascript:alert('XSS');">
 <SCRIPT/SRC="http://ha.ckers.org/xss.js"></SCRIPT>
```

#### XSS的防御

```
对输入和URL进行编码过滤
	在输入端可以写一个 xss filter
	
对输出进行编码

使用httpOnly
```

####  解析漏洞

```
IIS 6.0
/xx.asp/xx.jpg "xx.asp"是文件夹名

IIS 7.0/7.5
默认Fast-CGI开启，直接在url中图片地址后面输入/1.php，会把正常图片当成php解析

Nginx
版本小于等于0.8.37，利用方法和IIS 7.0/7.5一样，Fast-CGI关闭情况下也可利用。
空字节代码 xxx.jpg%00.php

Apache
上传的文件命名为：test.php.x1.x2.x3，Apache是从右往左判断后缀

lighttpd
xx.jpg/xx.php
```

#### 如何手工快速判断目标站是windows还是linux服务器？

```
windows
	大小写不敏感
Linux
	大小写敏感
```

#### SRC常见的某些漏洞

可以面试的时候举例，具体还是自己经验为主

```
api接口发现有未授权漏洞
websocket orgin头未验证
重置密码处可以任意用户重置
```

#### 垂直越权和水平越权

``` 
垂直越权
	低权限用户尝试访问高权限的目录
		盲猜admin.php
水平越权
	枚举id，访问其他用户的页面
```

####  反序列化的原理

```
序列化就是把对象转换成字节流，便于保存在内存、文件、数据库中,反序列化即逆过程，由字节流还原成对象
Java序列化
	WebLogic、WebSphere、JBoss、Jenkins、OpenNMS这些应用的反序列化漏洞
php序列化
	PHP反序列化的时候，基本都是围绕着serialize()，unserialize()这两个函数

```

#### CSRF防御

```
增加验证码机制，增加带有大量噪点的验证码，杜绝代码能够识别的简单验证码，当然了也经常被绕过

验证referer,采用同源政策，referer记录着数据包的来源地址，来判断请求的合法性，但是这个可以伪造

使用Token，令牌是一种将表单value的加密算法生成不同的加密结果，在服务器端进行验证。

在访问登录过一个网站，点击退出账户。
```

#### SSRF防御

```
过滤返回信息，如果web应用数去获取某一类型文件，在把结果返回给用户之前先验证信息是否符合标准。

例如：当攻击者利用"识别图片"下的该漏洞远程包含一个文件，可以通过在服务器上验证返回数据是否是纯像素，来进行过滤。

统一错误页

限制请求端口为http常用端口 80,443,8080,8090

内网IP黑名单，避免应用被用来获取内网数据，攻击内网
```

#### 描述两个最近的CVE

```